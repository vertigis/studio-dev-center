"use strict";(globalThis.webpackChunkvertigis_studio_dev_center=globalThis.webpackChunkvertigis_studio_dev_center||[]).push([[2316,3641],{5401:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>u,toc:()=>p});var o=t(4848),a=t(8453),i=(t(6025),t(1470)),s=t(9365),r=t(7034);const c={title:"Commands and Operations",description:"VertiGIS Studio Mobile - Learn how to register and run commands and operations in custom services and components"},l=void 0,u={id:"mobile/sdk-commands-operations",title:"Commands and Operations",description:"VertiGIS Studio Mobile - Learn how to register and run commands and operations in custom services and components",source:"@site/docs/mobile/sdk-commands-operations.mdx",sourceDirName:"mobile",slug:"/mobile/sdk-commands-operations",permalink:"/docs/mobile/sdk-commands-operations",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/mobile/sdk-commands-operations.mdx",tags:[],version:"current",frontMatter:{title:"Commands and Operations",description:"VertiGIS Studio Mobile - Learn how to register and run commands and operations in custom services and components"},sidebar:"mobile",previous:{title:"Deployment",permalink:"/docs/mobile/sdk-deployment"},next:{title:"Overview",permalink:"/docs/mobile/sdk-components-overview"}},d={},p=[{value:"Running Commands and Operations",id:"running-commands-and-operations",level:2},{value:"Implementing Commands and Operations",id:"implementing-commands-and-operations",level:2},{value:"Direct Registration and Implementation",id:"direct-registration-and-implementation",level:3},...r.toc,{value:"Registration with <code>OperationsBase</code>",id:"registration-with-operationsbase",level:3},{value:"Running Custom Commands",id:"running-custom-commands",level:2},{value:"Relevant SDK Sample",id:"relevant-sdk-sample",level:2}];function m(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["When writing custom components you may want to take advantage of VertiGIS Studio Mobile's large ",(0,o.jsx)(n.a,{href:"/docs/mobile/api-commands-operations",children:"built-in suite of command and operations"})," or your own ",(0,o.jsx)(n.a,{href:"/docs/mobile/sdk-commands-operations#implementing-commands-and-operations",children:"custom commands and operations"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"running-commands-and-operations",children:"Running Commands and Operations"}),"\n",(0,o.jsx)(n.p,{children:"Services and components can run commands and operations through dependency injection."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:"class CustomComponent : ComponentBase\n{\n    private readonly SystemOperations _systemOperations;\n\n    // highlight-next-line\n    public CustomComponent(SystemOperations systemOperations)\n    {\n        _systemOperations = systemOperations;\n    }\n\n    public async void CopyButtonClicked(string text)\n    {\n        // highlight-next-line\n        await _systemOperations.CopyToClipboard.ExecuteAsync(text);\n    }\n    ...\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"implementing-commands-and-operations",children:"Implementing Commands and Operations"}),"\n",(0,o.jsxs)(n.p,{children:["Services and components can also register an implementation for any command or operation. Commands and operations can either be registered and implemented directly in a service or component, or registered in a class that extends ",(0,o.jsx)(n.code,{children:"OperationsBase"})," for ease of use by other components and services."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"Multiple implementations can be registered for a Command or Operation."})}),"\n",(0,o.jsx)(n.h3,{id:"direct-registration-and-implementation",children:"Direct Registration and Implementation"}),"\n",(0,o.jsxs)(n.p,{children:["Commands and operations can be directly registered and implemented in a service or component through the ",(0,o.jsx)(n.code,{children:"IOperationRegistry"}),".\nThis pattern can be useful for registering dynamically generated commands or implementations."]}),"\n",(0,o.jsx)(r.default,{}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:'class CustomService : ServiceBase\n{\n    private readonly IOperationRegistry _operationRegistry;\n\n    // highlight-start\n    public CustomService(IOperationRegistry operationRegistry)\n    {\n        // Define an operation that takes a string and returns the length of it.\n        operationRegistry.Operation<string, int>("custom.string-len").RegisterExecute(_executeStringLen, this);\n        // highlight-end\n    }\n\n    private async Task<int> _executeStringLen(string arg)\n    {\n        return arg != null ? arg.Length : 0;\n    }\n    ...\n}\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"registration-with-operationsbase",children:["Registration with ",(0,o.jsx)(n.code,{children:"OperationsBase"})]}),"\n",(0,o.jsxs)(n.p,{children:["Commands and operations can also be defined in an ",(0,o.jsx)(n.code,{children:"OperationsBase"})," class, which can then be injected into any service or component that wants to register an implementation."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["An ",(0,o.jsx)(n.code,{children:"IVoidOperation"})," produces no output, and optionally takes an input."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:'public IVoidOperation NoInputNoOutput => GetVoidOperation("fire.phasers");\npublic IVoidOperation<Temperature> SomeInputNoOutput => GetVoidOperation<Temperature>("tea.earl-grey");\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["An ",(0,o.jsx)(n.code,{children:"IOperation"})," produces an output, and optionally takes an input."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:'public IOperation<SomeOutput> NoInputSomeOutput => GetOperation<SomeOutput>("custom.operation");\npublic IOperation<Deuterium, WarpSpeed> SomeInputSomeOutput => GetOperation<Deuterium, WarpSpeed>("warp-drive.engage");\n'})}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["Operation names in VertiGIS Studio Mobile generally take the format ",(0,o.jsx)(n.code,{children:"<category>.<name>"}),", with multiple words ",(0,o.jsx)(n.code,{children:"kebab-cased"}),"."]})}),"\n",(0,o.jsxs)(n.p,{children:["These types can be used to define a set of operations in an ",(0,o.jsx)(n.code,{children:"OperationsBase"})," class that is registered with Autofac. Implementations for the operations can then be registered in a service or component."]}),"\n",(0,o.jsxs)(i.A,{defaultValue:"operations",values:[{label:"OperationsBase",value:"operations"},{label:"Custom Component",value:"component"}],children:[(0,o.jsx)(s.A,{value:"operations",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:'// highlight-next-line\n[assembly: Export(typeof(CustomOperations), SingleInstance = true)]\nnamespace App1.Operations\n{\n    class CustomOperations : OperationsBase\n    {\n        // highlight-start\n        public IVoidOperation<string> RunCustomCommand => GetVoidOperation<string>("custom.command-string-input");\n\n        public IOperation<int> RunCustomOperation => GetOperation<int>("custom.operation-int-output");\n\n        public IOperation<string, int> RunCustomOperationWithInput => GetOperation<string, int>("custom.operation-string-input-int-output");\n        // highlight-end\n\n        public Operation(IOperationRegistry operationRegistry)\n            : base(operationRegistry)\n        {\n        }\n    }\n}\n'})})}),(0,o.jsx)(s.A,{value:"component",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:"class CustomComponent : ComponentBase\n{\n    public CustomComponent(CustomOperations customOperations)\n    {\n        // highlight-start\n        customOperations.RunCustomCommand.RegisterExecute(_executeRunCustomCommand, this);\n\n        customOperations.RunCustomOperation.RegisterExecute(_executeRunCustomOperation, this);\n\n        customOperations.RunCustomOperationWithInput.RegisterExecute(_executeRunCustomOperationWithInput, this);\n        // highlight-end\n    }\n\n    private async Task _executeRunCustomCommand(string arg)\n    {\n        // ... implementation for run custom command.\n    }\n\n    private async Task<int> _executeRunCustomOperation()\n    {\n        // ... implementation for run custom operations.\n    }\n\n    private async Task<int> _executeRunCustomOperationWithInput(string arg)\n    {\n        // ... implementation for run custom operation with input.\n    }\n    ...\n}\n"})})})]}),"\n",(0,o.jsx)(n.h2,{id:"running-custom-commands",children:"Running Custom Commands"}),"\n",(0,o.jsxs)(n.p,{children:["You can run the custom commands or operations you define by either injecting the appropriate ",(0,o.jsx)(n.code,{children:"OperationsBase"})," class or using the ",(0,o.jsx)(n.code,{children:"IOperationRegistry"})," to run the command or operation by name."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-cs",children:'class CustomService : ServiceBase\n{\n    private readonly CustomOperations _customOperations;\n\n    private readonly IOperationRegistry _operationRegistry;\n\n    // highlight-next-line\n    public CustomService(CustomOperations customOperations, IOperationRegistry operationRegistry)\n    {\n        _customOperations = customOperations;\n        _operationRegistry = operationRegistry;\n    }\n\n    // highlight-start\n    private async void runSomeCommand()\n    {\n        await _customOperations.RunCustomCommand.ExecuteAsync("some arg");\n        // Execute the same operation but by name instead of through the `OperationsBase` container.\n        await _operationRegistry.VoidOperation("custom.command-string-input").ExecuteAsync("Some arg");\n    }\n    // highlight-end\n    ...\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"relevant-sdk-sample",children:"Relevant SDK Sample"}),"\n",(0,o.jsxs)(n.p,{children:["The VertiGIS Studio Mobile SDK Samples project has a sample of ",(0,o.jsx)(n.a,{href:"https://github.com/vertigis/vertigis-mobile-samples/tree/master/VSM.Samples/VSM.Samples/Samples/Custom/Service",children:"implementing a command with a custom service"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},7034:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var o=t(4848),a=t(8453);const i={},s=void 0,r={id:"mobile/snippets/cleanup-handles",title:"cleanup-handles",description:"It is vital that subscription handles are cleaned up when the object is cleaned up, otherwise dangling references can occur. This can be done by implementing the IDisposable and IDisposableTracker interface, and then providing this as the second argument to a call to subscribe. ServiceBase and ComponentBase already implement these interfaces so you don't have to.",source:"@site/docs/mobile/snippets/cleanup-handles.mdx",sourceDirName:"mobile/snippets",slug:"/mobile/snippets/cleanup-handles",permalink:"/docs/mobile/snippets/cleanup-handles",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/mobile/snippets/cleanup-handles.mdx",tags:[],version:"current",frontMatter:{}},c={},l=[];function u(e){const n={admonition:"admonition",code:"code",p:"p",...(0,a.R)(),...e.components};return(0,o.jsx)(n.admonition,{title:"Important",type:"info",children:(0,o.jsxs)(n.p,{children:["It is vital that subscription handles are cleaned up when the object is cleaned up, otherwise dangling references can occur. This can be done by implementing the ",(0,o.jsx)(n.code,{children:"IDisposable"})," and ",(0,o.jsx)(n.code,{children:"IDisposableTracker"})," interface, and then providing ",(0,o.jsx)(n.code,{children:"this"})," as the second argument to a call to subscribe. ",(0,o.jsx)(n.code,{children:"ServiceBase"})," and ",(0,o.jsx)(n.code,{children:"ComponentBase"})," already implement these interfaces so you don't have to."]})})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>s});t(6540);var o=t(8215);const a={tabItem:"tabItem_Ymn6"};var i=t(4848);function s({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,o.A)(a.tabItem,t),hidden:n,children:e})}},1470:(e,n,t)=>{t.d(n,{A:()=>j});var o=t(6540),a=t(8215),i=t(3104),s=t(6347),r=t(205),c=t(7485),l=t(1682),u=t(9466);function d(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,o.useMemo)((()=>{const e=n??function(e){return d(e).map((({props:{value:e,label:n,attributes:t,default:o}})=>({value:e,label:n,attributes:t,default:o})))}(t);return function(e){const n=(0,l.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m({value:e,tabValues:n}){return n.some((n=>n.value===e))}function h({queryString:e=!1,groupId:n}){const t=(0,s.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(a),(0,o.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(t.location.search);n.set(a,e),t.replace({...t.location,search:n.toString()})}),[a,t])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,i=p(e),[s,c]=(0,o.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[l,d]=h({queryString:t,groupId:a}),[g,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,a]=(0,u.Dv)(n);return[t,(0,o.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:a}),v=(()=>{const e=l??g;return m({value:e,tabValues:i})?e:null})();(0,r.A)((()=>{v&&c(v)}),[v]);return{selectedValue:s,selectValue:(0,o.useCallback)((e=>{if(!m({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);c(e),d(e),b(e)}),[d,b,i]),tabValues:i}}var b=t(2303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(4848);function f({className:e,block:n,selectedValue:t,selectValue:o,tabValues:s}){const r=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),l=e=>{const n=e.currentTarget,a=r.indexOf(n),i=s[a].value;i!==t&&(c(n),o(i))},u=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=r.indexOf(e.currentTarget)+1;n=r[t]??r[0];break}case"ArrowLeft":{const t=r.indexOf(e.currentTarget)-1;n=r[t]??r[r.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:o})=>(0,x.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>r.push(e),onKeyDown:u,onClick:l,...o,className:(0,a.A)("tabs__item",v.tabItem,o?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function y({lazy:e,children:n,selectedValue:t}){const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=a.find((e=>e.props.value===t));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function O(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,a.A)("tabs-container",v.tabList),children:[(0,x.jsx)(f,{...e,...n}),(0,x.jsx)(y,{...e,...n})]})}function j(e){const n=(0,b.A)();return(0,x.jsx)(O,{...e,children:d(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var o=t(6540);const a={},i=o.createContext(a);function s(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);