"use strict";(globalThis.webpackChunkvertigis_studio_dev_center=globalThis.webpackChunkvertigis_studio_dev_center||[]).push([[4160],{6484:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var t=s(7624),i=s(2172);const o={title:"Events Reference",description:"VertiGIS Studio Web - Events Reference"},r=void 0,c={id:"web/sdk-events-reference",title:"Events Reference",description:"VertiGIS Studio Web - Events Reference",source:"@site/docs/web/sdk-events-reference.mdx",sourceDirName:"web",slug:"/web/sdk-events-reference",permalink:"/docs/web/sdk-events-reference",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/web/sdk-events-reference.mdx",tags:[],version:"current",frontMatter:{title:"Events Reference",description:"VertiGIS Studio Web - Events Reference"},sidebar:"web",previous:{title:"Overview",permalink:"/docs/web/sdk-events-overview"},next:{title:"Commands and Operations",permalink:"/docs/web/sdk-commands-operations"}},a={},d=[{value:"Publishing Events",id:"publishing-events",level:2},{value:"Services",id:"services",level:3},{value:"Component Models",id:"component-models",level:3},{value:"Components",id:"components",level:3},{value:"Subscribing to Events",id:"subscribing-to-events",level:2},{value:"Services",id:"services-1",level:3},{value:"Component Models",id:"component-models-1",level:3},{value:"Components",id:"components-1",level:3},{value:"Creating Custom Events",id:"creating-custom-events",level:2},{value:"Event Arguments",id:"event-arguments",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Events can be published, subscribed, or created by an custom service, component model, or component."}),"\n",(0,t.jsx)(n.h2,{id:"publishing-events",children:"Publishing Events"}),"\n",(0,t.jsxs)(n.p,{children:["Events can be published by calling the ",(0,t.jsx)(n.code,{children:".publish"})," method on the event object."]}),"\n",(0,t.jsx)(n.h3,{id:"services",children:"Services"}),"\n",(0,t.jsxs)(n.p,{children:["Events are accessed in services through the ",(0,t.jsx)(n.code,{children:"messages"})," property."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export default class CustomService extends ServiceBase {\n    customIdentify() {\n        // ... run a custom identify here.\n        this.messages.events.tasks.identified.publish(someFeatures);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"component-models",children:"Component Models"}),"\n",(0,t.jsxs)(n.p,{children:["Events are accessed in component models through the ",(0,t.jsx)(n.code,{children:"messages"})," property."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export default class ExampleComponentModel extends ComponentModelBase {\n    customIdentify() {\n        // ... run a custom identify here.\n        this.messages.events.tasks.identified.publish(someFeatures);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"components",children:"Components"}),"\n",(0,t.jsxs)(n.p,{children:["Events in components are accessed through the ",(0,t.jsx)(n.a,{href:"/docs/web/sdk-components-ui-context#accessing-the-uicontext",children:"UIContext"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"export default function ExampleComponent(\n    props: LayoutElementProperties<ExampleComponentModel>\n) {\n    const { events } = useContext(UIContext);\n\n    const customIdentify = () => {\n        // ... run a custom identify here.\n        this.messages.events.tasks.identified.publish(someFeatures);\n    };\n\n    return (\n        <LayoutElement {...props}>\n            <p>Hello World</p>\n        </LayoutElement>\n    );\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"subscribing-to-events",children:"Subscribing to Events"}),"\n",(0,t.jsxs)(n.p,{children:["Events can be subscribed to by calling the ",(0,t.jsx)(n.code,{children:".subscribe"})," method on the event object."]}),"\n",(0,t.jsx)(n.admonition,{title:"Important",type:"info",children:(0,t.jsx)(n.p,{children:"It is vital that the event handles are cleaned up when the object is cleaned up, otherwise dangling references can occur."})}),"\n",(0,t.jsx)(n.h3,{id:"services-1",children:"Services"}),"\n",(0,t.jsxs)(n.p,{children:["Events are accessed in services through the ",(0,t.jsx)(n.code,{children:"messages"})," property."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export default class CustomService extends ServiceBase {\n    handles: IHandle[] = [];\n\n    protected async _onInitialize(): Promise<void> {\n        await super._onInitialize();\n        this.handles.push(\n            this.messages.events.ui.activated.subscribe(\n                (id: string) => {\n                    console.log(`Component '${id}' activated.`);\n                }\n            )\n        );\n    }\n\n    protected async _onDestroy(): Promise<void> {\n        await super._onDestroy();\n        this.handles.forEach((handle) => handle.remove());\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"component-models-1",children:"Component Models"}),"\n",(0,t.jsxs)(n.p,{children:["Events are accessed in component models through the ",(0,t.jsx)(n.code,{children:"messages"})," property."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export default class ExampleComponentModel extends ComponentModelBase {\n    handles: IHandle[] = [];\n\n    protected async _onInitialize(): Promise<void> {\n        await super._onInitialize();\n        this.handles.push(\n            this.messages.events.ui.activated.subscribe(\n                (id: string) => {\n                    console.log(`Component '${id}' activated.`);\n                }\n            )\n        );\n    }\n\n    protected async _onDestroy(): Promise<void> {\n        await super._onDestroy();\n        this.handles.forEach((handle) => handle.remove());\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"components-1",children:"Components"}),"\n",(0,t.jsxs)(n.p,{children:["Events in components are accessed through the ",(0,t.jsx)(n.a,{href:"/docs/web/sdk-components-ui-context#accessing-the-uicontext",children:"UIContext"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["If you need to subscribe to events in a component, it's best practice to use the ",(0,t.jsx)(n.a,{href:"/docs/web/sdk-components-hooks",children:"component hooks"})," instead of a ",(0,t.jsx)(n.code,{children:"useEffect"}),", as the component hooks will automatically clean up the event handle."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"export default function ExampleComponent(\n    props: LayoutElementProperties<ExampleComponentModel>\n) {\n    const { events } = useContext(UIContext);\n\n    useSubscribe(events.ui.activated, (id: string) => {\n        console.log(`Component '${id}' activated.`);\n    });\n\n    return (\n        <LayoutElement {...props}>\n            <p>Hello World</p>\n        </LayoutElement>\n    );\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"creating-custom-events",children:"Creating Custom Events"}),"\n",(0,t.jsx)(n.p,{children:"Creating custom events is as simple as referencing the custom event by name and publishing or subscribing to it. This is because the logic of creating an event is abstracted away; if an event is referenced in a publish or subscribe call that doesn't exist yet, it will be automatically created."}),"\n",(0,t.jsxs)(n.p,{children:["When the service calls the ",(0,t.jsx)(n.code,{children:'this.messages.events("my.custom-event")'}),", this creates the event if it has not already been created. It can then be immediately subscribed to. Likewise, if the event has not been created, it will be when ",(0,t.jsx)(n.code,{children:'this.messages.event<string>("my-custom-event").publish(...)'})," is called."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'export default class CustomService extends ServiceBase {\n    handles: IHandle[] = [];\n\n    publishCustomEvent() {\n        // highlight-next-line\n        this.messages\n            .event<string>("my-custom-event")\n            .publish("some argument");\n    }\n\n    protected async _onInitialize(): Promise<void> {\n        await super._onInitialize();\n        this.handles.push(\n            // highlight-next-line\n            this.messages\n                .event<string>("my-custom-event")\n                .subscribe((someArg: string) => {\n                    console.log(\n                        `Event published with arg: \'${someArg}\'`\n                    );\n                })\n        );\n    }\n\n    protected async _onDestroy(): Promise<void> {\n        await super._onDestroy();\n        this.handles.forEach((handle) => handle.remove());\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"event-arguments",children:"Event Arguments"}),"\n",(0,t.jsx)(n.p,{children:"Events optionally take a type argument, which represents the object associated with the event consumed by the subscriber. This can be a simple or complex object."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'this.messages\n    .event<string>("my-custom-event")\n    .publish("Some String Arg")\n\nthis.messages\n    .event<string>("my-custom-event")\n    .subscribe((someArg: string) => { ... })\n\nthis.messages\n    .event<CustomType>("another-custom-event")\n    .publish(new CustomType("param"))\n\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},2172:(e,n,s)=>{s.d(n,{I:()=>c,M:()=>r});var t=s(1504);const i={},o=t.createContext(i);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);