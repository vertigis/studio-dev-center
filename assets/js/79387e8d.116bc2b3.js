"use strict";(globalThis.webpackChunkvertigis_studio_dev_center=globalThis.webpackChunkvertigis_studio_dev_center||[]).push([[5620,3988],{7372:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var i=n(7624),r=n(2172),o=n(4676);const s={title:"Integrating the ArcGIS API for JavaScript",description:"VertiGIS Studio Workflow - Integrate the ArcGIS API for JavaScript into custom activities for web applications"},a=void 0,c={id:"workflow/sdk-web-integrating-the-arcgis-api",title:"Integrating the ArcGIS API for JavaScript",description:"VertiGIS Studio Workflow - Integrate the ArcGIS API for JavaScript into custom activities for web applications",source:"@site/docs/workflow/sdk-web-integrating-the-arcgis-api.mdx",sourceDirName:"workflow",slug:"/workflow/sdk-web-integrating-the-arcgis-api",permalink:"/docs/workflow/sdk-web-integrating-the-arcgis-api",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/workflow/sdk-web-integrating-the-arcgis-api.mdx",tags:[],version:"current",frontMatter:{title:"Integrating the ArcGIS API for JavaScript",description:"VertiGIS Studio Workflow - Integrate the ArcGIS API for JavaScript into custom activities for web applications"},sidebar:"workflow",previous:{title:"Form Element Reference",permalink:"/docs/workflow/sdk-web-form-reference"},next:{title:"Activity Block Tags",permalink:"/docs/workflow/sdk-web-activity-block-tags"}},p={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Add ArcGIS API for JavaScript Typings",id:"add-arcgis-api-for-javascript-typings",level:2},{value:"Create an Activity",id:"create-an-activity",level:2},{value:"Use ArcGIS Types",id:"use-arcgis-types",level:2},{value:"Example: Custom Activity for Expanding a Polygon",id:"example-custom-activity-for-expanding-a-polygon",level:3},{value:"Build Activities to work with both 3.x and 4.x ArcGIS API for JavaScript Versions",id:"build-activities-to-work-with-both-3x-and-4x-arcgis-api-for-javascript-versions",level:2},{value:"Example: 3.x and 4.x Compatible Custom Activity for Expanding a Polygon",id:"example-3x-and-4x-compatible-custom-activity-for-expanding-a-polygon",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"https://apps.vertigisstudio.com/workflow/designer/",children:"VertiGIS Studio Workflow"})," was designed to be a flexible tool for implementing business logic for mapping applications, and tightly integrates with ArcGIS API for JavaScript. You may want to use the ArcGIS API in your own custom activities; this article will explain how to reference ArcGIS API types in your custom activity or custom form element for web applications."]}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(o.default,{}),"\n",(0,i.jsx)(t.h2,{id:"add-arcgis-api-for-javascript-typings",children:"Add ArcGIS API for JavaScript Typings"}),"\n",(0,i.jsxs)(t.p,{children:["Type information for the ArcGIS API for JavaScript is provided by the ",(0,i.jsx)(t.a,{href:"https://www.npmjs.com/package/@types/arcgis-js-api",children:"@types/arcgis-js-api"})," package. You need to install the version of this package that matches the version of the ArcGIS API for JavaScript present in the application where your activities and form elements will be used."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Open up a terminal shell in the SDK folder."}),"\n",(0,i.jsxs)(t.li,{children:["Run the ",(0,i.jsx)(t.code,{children:"npm install @types/arcgis-js-api"})," command for the desired version of the ArcGIS API for JavaScript."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["For applications like ",(0,i.jsx)(t.a,{href:"https://www.vertigisstudio.com/products/vertigis-studio-web/",children:"VertiGIS Studio Web"})," that use the 4.x ArcGIS API for JavaScript use:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"npm install @types/arcgis-js-api@4.17.0\n"})}),"\n",(0,i.jsxs)(t.p,{children:["For applications like ",(0,i.jsx)(t.a,{href:"https://docs.vertigisstudio.com/essentials/gvh/",children:"Geocortex Viewer for HTML5"})," or ",(0,i.jsx)(t.a,{href:"https://www.esri.com/en-us/arcgis/products/web-appbuilder/overview",children:"Web AppBuilder for ArcGIS"})," (2D) that use the 3.x ArcGIS API for JavaScript use:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"npm install @types/arcgis-js-api@3.33.0\n"})}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["The exact minor and patch version numbers of the ",(0,i.jsx)(t.code,{children:"@types/arcgis-js-api"})," package are often not critical. However, it is important to use the correct major version 3.x vs. 4.x."]})}),"\n",(0,i.jsx)(t.h2,{id:"create-an-activity",children:"Create an Activity"}),"\n",(0,i.jsxs)(t.p,{children:["Follow the instructions in ",(0,i.jsx)(t.a,{href:"/docs/workflow/sdk-web-create-activity",children:"Create an Activity"})," to create a custom workflow activity."]}),"\n",(0,i.jsx)(t.h2,{id:"use-arcgis-types",children:"Use ArcGIS Types"}),"\n",(0,i.jsxs)(t.p,{children:["To reference ArcGIS types you add ",(0,i.jsx)(t.code,{children:"import"})," statements at the top of the file containing your custom activity."]}),"\n",(0,i.jsxs)(t.p,{children:["For example, to use the ",(0,i.jsx)(t.code,{children:"esri/geometry/Extent"})," type add the following ",(0,i.jsx)(t.code,{children:"import"})," statement:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:'import * as Extent from "esri/geometry/Extent";\n'})}),"\n",(0,i.jsx)(t.h3,{id:"example-custom-activity-for-expanding-a-polygon",children:"Example: Custom Activity for Expanding a Polygon"}),"\n",(0,i.jsx)(t.p,{children:"This is a custom activity which imports types from the ArcGIS API for JavaScript to expand a polygon by a given factor and returns the new extent bounds."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:'import type { IActivityHandler } from "@vertigis/workflow/IActivityHandler";\n// highlight-start\nimport * as Extent from "esri/geometry/Extent";\nimport * as Polygon from "esri/geometry/Polygon";\n// highlight-end\n\nexport interface ExpandPolygonInputs {\n    /**\n     * @description The polygon to expand.\n     * @required\n     */\n    // highlight-next-line\n    polygon: Polygon;\n\n    /**\n     * @description The factor to expand the polygon extent by.\n     * @required\n     */\n    factor: number;\n}\n\nexport interface ExpandPolygonOutputs {\n    /**\n     * @description The extent bounds for the expanded polygon.\n     * @required\n     */\n    // highlight-next-line\n    extent: Extent;\n}\n\n/**\n * @category Custom Activities\n * @description An activity that expands the bounding extent of a polygon by a given factor.\n */\nexport class ExpandPolygon implements IActivityHandler {\n    async execute(\n        inputs: ExpandPolygonInputs\n    ): Promise<ExpandPolygonOutputs> {\n        return {\n            // highlight-next-line\n            extent: inputs.polygon.getExtent().expand(inputs.factor),\n        };\n    }\n}\n'})}),"\n",(0,i.jsx)(t.h2,{id:"build-activities-to-work-with-both-3x-and-4x-arcgis-api-for-javascript-versions",children:"Build Activities to work with both 3.x and 4.x ArcGIS API for JavaScript Versions"}),"\n",(0,i.jsx)(t.p,{children:"VertiGIS Studio Workflow is designed to work with both the 3.x and 4.x versions of the ArcGIS API for JavaScript; however, many custom activity implementations only bother to support one or the other."}),"\n",(0,i.jsxs)(t.p,{children:["If you need to support both ArcGIS API versions, then you may need to account for differences between the APIs in your code. For more details on these differences, see the developer documentation for the ",(0,i.jsx)(t.a,{href:"https://developers.arcgis.com/javascript/",children:"4.x ArcGIS API for JavaScript"})," and the ",(0,i.jsx)(t.a,{href:"https://developers.arcgis.com/javascript/3/",children:"3.x ArcGIS API for JavaScript"})," respectively."]}),"\n",(0,i.jsxs)(t.p,{children:["You can structure your activity to be compatible with differences between API versions by using the ",(0,i.jsx)(t.code,{children:"esri/kernel"})," module to determine the API version that the activity is running in."]}),"\n",(0,i.jsx)(t.p,{children:"The following code provides a convenient utility function to distinguish between 3.x and 4.x versions:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:'// highlight-next-line\nimport * as kernel from "esri/kernel";\n\nenum ArcGisApiVersion {\n    Unknown,\n    v3,\n    v4,\n}\n\nconst getArcGISApiVersion = (): ArcGisApiVersion => {\n    // highlight-next-line\n    const prefix = kernel.version.substr(0, 2);\n    if (prefix === "4.") {\n        return ArcGisApiVersion.v4;\n    } else if (prefix === "3.") {\n        return ArcGisApiVersion.v3;\n    } else {\n        return ArcGisApiVersion.Unknown;\n    }\n};\n'})}),"\n",(0,i.jsx)(t.h3,{id:"example-3x-and-4x-compatible-custom-activity-for-expanding-a-polygon",children:"Example: 3.x and 4.x Compatible Custom Activity for Expanding a Polygon"}),"\n",(0,i.jsxs)(t.p,{children:["This example builds on the ExpandPolygon activity to make it work with both the 3.x and 4.x versions of the ArcGIS API for JavaScript. The ",(0,i.jsx)(t.code,{children:"execute"})," method of the activity checks the ArcGIS API version and executes the appropriate code for the given API."]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["Since the SDK can only reference one version of the ",(0,i.jsx)(t.code,{children:"@types/arcgis-js-api"})," package at time, you will have to cast to ",(0,i.jsx)(t.code,{children:"any"})," for the other API version types when necessary to avoid TypeScript errors."]})}),"\n",(0,i.jsxs)(t.p,{children:["In this example, the way the Extent of a polygon is retrieved is the difference between the APIs. In 4.x, ",(0,i.jsx)(t.code,{children:"extent"})," is a property, while in 3.x extent is retrieved using the ",(0,i.jsx)(t.code,{children:"getExtent()"})," method. The APIs converge after this, with both supporting the ",(0,i.jsx)(t.code,{children:"expand(factor)"})," method."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:'import type { IActivityHandler } from "@vertigis/workflow/IActivityHandler";\nimport * as Extent from "esri/geometry/Extent";\nimport * as Polygon from "esri/geometry/Polygon";\nimport * as kernel from "esri/kernel";\n\nenum ArcGisApiVersion {\n    Unknown,\n    v3,\n    v4,\n}\n\nconst getArcGISApiVersion = (): ArcGisApiVersion => {\n    const prefix = kernel.version.substr(0, 2);\n    if (prefix === "4.") {\n        return ArcGisApiVersion.v4;\n    } else if (prefix === "3.") {\n        return ArcGisApiVersion.v3;\n    } else {\n        return ArcGisApiVersion.Unknown;\n    }\n};\n\nexport interface ExpandPolygonInputs {\n    /**\n     * @description The polygon to Expand.\n     * @required\n     */\n    polygon: Polygon;\n\n    /**\n     * @description The factor to expand the polygon extent by.\n     * @required\n     */\n    factor: number;\n}\n\nexport interface ExpandPolygonOutputs {\n    /**\n     * @description The extent bounds for the expanded polygon.\n     */\n    extent: Extent;\n}\n\n/**\n * @category Custom Activities\n * @description An activity that expands the bounding extent of a polygon by a given factor.\n */\nexport class ExpandPolygon implements IActivityHandler {\n    async execute(\n        inputs: ExpandPolygonInputs\n    ): Promise<ExpandPolygonOutputs> {\n        const apiVersion = getArcGISApiVersion();\n        let extent;\n        if (apiVersion == ArcGisApiVersion.v4) {\n            // highlight-next-line\n            extent = (inputs.polygon as any).extent;\n        } else if (apiVersion == ArcGisApiVersion.v3) {\n            // highlight-next-line\n            extent = inputs.polygon.getExtent();\n        } else {\n            throw new Error(\n                `ArcGIS JS API Version version \'${apiVersion}\' not recognized.`\n            );\n        }\n\n        return {\n            extent: extent.expand(inputs.factor),\n        };\n    }\n}\n'})})]})}function h(e={}){const{wrapper:t}={...(0,r.M)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},4676:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>p});var i=n(7624),r=n(2172);const o={},s=void 0,a={id:"workflow/snippets/prereqs-web",title:"prereqs-web",description:"Follow the instructions in the Web Applications SDK page to set up your development environment.",source:"@site/docs/workflow/snippets/prereqs-web.mdx",sourceDirName:"workflow/snippets",slug:"/workflow/snippets/prereqs-web",permalink:"/docs/workflow/snippets/prereqs-web",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/workflow/snippets/prereqs-web.mdx",tags:[],version:"current",frontMatter:{}},c={},p=[];function l(e){const t={a:"a",admonition:"admonition",p:"p",...(0,r.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["Follow the instructions in the ",(0,i.jsx)(t.a,{href:"/docs/workflow/sdk-web-overview",children:"Web Applications SDK"})," page to set up your development environment."]}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["A working knowledge of ",(0,i.jsx)(t.a,{href:"https://www.typescriptlang.org/",children:"TypeScript"})," is recommended before extending Workflow for web-based hosts."]})})]})}function d(e={}){const{wrapper:t}={...(0,r.M)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},2172:(e,t,n)=>{n.d(t,{I:()=>a,M:()=>s});var i=n(1504);const r={},o=i.createContext(r);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);