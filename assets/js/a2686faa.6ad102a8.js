"use strict";(globalThis.webpackChunkvertigis_studio_dev_center=globalThis.webpackChunkvertigis_studio_dev_center||[]).push([[8696],{7264:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>u,default:()=>g,frontMatter:()=>d,metadata:()=>p,toc:()=>m});var i=t(7624),r=t(2172),o=t(964),s=t(7528),l=t(7160),a=t(1268),c=t(5388);const d={title:"Serializable Properties",description:"VertiGIS Studio Web - Learn how to serialize and deserialize app config properties"},u=void 0,p={id:"web/sdk-serializable-properties",title:"Serializable Properties",description:"VertiGIS Studio Web - Learn how to serialize and deserialize app config properties",source:"@site/docs/web/sdk-serializable-properties.mdx",sourceDirName:"web",slug:"/web/sdk-serializable-properties",permalink:"/docs/web/sdk-serializable-properties",draft:!1,unlisted:!1,editUrl:"https://github.com/vertigis/studio-dev-center/edit/master/docs/web/sdk-serializable-properties.mdx",tags:[],version:"current",frontMatter:{title:"Serializable Properties",description:"VertiGIS Studio Web - Learn how to serialize and deserialize app config properties"},sidebar:"web",previous:{title:"Commands and Operations",permalink:"/docs/web/sdk-commands-operations"},next:{title:"Adding Icons",permalink:"/docs/web/sdk-adding-icons"}},h={},m=[{value:"Defining a Serializable Class",id:"defining-a-serializable-class",level:2},{value:"Populating the Class with Configuration Values.",id:"populating-the-class-with-configuration-values",level:2},{value:"Serialization Modes",id:"serialization-modes",level:2},{value:"Next Steps",id:"next-steps",level:2}];function f(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"VertiGIS Studio Web uses static, plain, app config JSON files to represent settings and properties for various components and services in an application. At some point, each of the values in the JSON file must be serialized and populate a JavaScript object. Component models and custom services can both consume configuration; therefore, they must also define the logic for translating configuration to runtime values."}),"\n",(0,i.jsx)(n.h2,{id:"defining-a-serializable-class",children:"Defining a Serializable Class"}),"\n",(0,i.jsxs)(n.p,{children:["In order for a component to participate in configuration, it must be marked as serializable with the ",(0,i.jsx)(n.code,{children:"@serializable"})," decorator."]}),"\n",(0,i.jsxs)(a.c,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"}],children:[(0,i.jsx)(c.c,{value:"model",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"...\n// highlight-next-line\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n    ...\n}\n"})})}),(0,i.jsx)(c.c,{value:"service",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"...\n// highlight-next-line\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n   items: Collection<string> = new Collection<string>();\n\n"})})})]}),"\n",(0,i.jsxs)(n.p,{children:["Every serializable class extends a generically typed base class, like ",(0,i.jsx)(n.code,{children:"ComponentModelBase"})," or ",(0,i.jsx)(n.code,{children:"ConfigurableServiceBase"}),". The type passed into the base class is an interface consisting of primitive, serializable types, like ",(0,i.jsx)(n.code,{children:"number"}),", ",(0,i.jsx)(n.code,{children:"string"}),", ",(0,i.jsx)(n.code,{children:"array"}),", ",(0,i.jsx)(n.code,{children:"boolean"}),", etc. Each property on the interface will correspond exactly to a property in the app config JSON."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Marking properties in the ",(0,i.jsx)(n.code,{children:"ComponentModelProperties"})," interface as optional allows them to be left out of config and populated with default values. It's best practice to make properties optional and provide a default value if possible."]})}),"\n",(0,i.jsxs)(a.c,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"},{label:"App Config",value:"config"}],children:[(0,i.jsx)(c.c,{value:"model",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"...\n// highlight-start\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    items?: string[];\n}\n// highlight-end\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n    ...\n}\n"})})}),(0,i.jsx)(c.c,{value:"service",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"...\n// highlight-start\ninterface CustomServiceProperties extends ComponentModelProperties {\n    items?: string[];\n}\n// highlight-end\n\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n   items: Collection<string> = new Collection<string>();\n\n"})})}),(0,i.jsx)(c.c,{value:"config",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "schemaVersion": "1.0",\n    "items": [\n        ...\n        {\n            "$type": "custom-service",\n            "id": "custom-service-config",\n            "title": "Custom Service Config",\n            // highlight-next-line\n            "items": ["some", "string", "values"]\n        },\n        {\n            "$type": "example-component-model",\n            "id": "example-component-model-config",\n            "title": "Example Component Model Config",\n            // highlight-next-line\n            "items": ["more", "string", "values"]\n        }\n        ...\n    ]\n}\n'})})})]}),"\n",(0,i.jsx)(n.h2,{id:"populating-the-class-with-configuration-values",children:"Populating the Class with Configuration Values."}),"\n",(0,i.jsxs)(n.p,{children:["The class is responsible for turning the ",(0,i.jsx)(n.code,{children:"ComponentModelProperties"})," interface, which will be populated with primitive values from the app config JSON, into complex properties on the class object itself. This work is done through the ",(0,i.jsx)(n.code,{children:"_getSerializableProperties"})," method."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"_getSerializableProperties()"})," method has a few purposes."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Provide deserialization logic from the ",(0,i.jsx)(n.code,{children:"ComponentModelProperties"})," interface to class properties."]}),"\n",(0,i.jsxs)(n.li,{children:["Provide serialization logic from an class property to the ",(0,i.jsx)(n.code,{children:"ComponentModelProperties"})," interface, which can be serialized in a JSON file."]}),"\n",(0,i.jsx)(n.li,{children:"Provide a default value for the JSON object if one is not given in the app config."}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Important",type:"info",children:(0,i.jsxs)(n.p,{children:["It's key that the existing properties also get serialized through a call to ",(0,i.jsx)(n.code,{children:"super._getSerializableProperties()"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:["In the following example, the serialization logic for the ",(0,i.jsx)(n.code,{children:"ExampleComponentModelProperties"})," string array property ",(0,i.jsx)(n.code,{children:"items"})," is defined. The corresponding class property is an ",(0,i.jsx)(n.a,{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-core-Collection.html",children:"ArcGIS API for JavaScript Collection"}),". Therefore, the ",(0,i.jsx)(n.code,{children:"deserialize"})," method takes each item from the string array, and adds it to to collection. The ",(0,i.jsx)(n.code,{children:"serialize"})," method does the opposite, turning the collection into a plain string array. A default value for the ",(0,i.jsx)(n.code,{children:"string[]"})," is also provided."]}),"\n",(0,i.jsxs)(a.c,{defaultValue:"model",values:[{label:"Custom Component Model",value:"model"},{label:"Custom Service",value:"service"}],children:[(0,i.jsx)(c.c,{value:"model",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'...\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    items?: string[];\n}\n\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    items: Collection<string> = new Collection<string>();\n\n    ...\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        // highlight-next-line\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            items: {\n\n                serializeModes: ["initial"],\n                default: ["Some Default Value"],\n                serialize: () => this.items.toArray(),\n                deserialize: (items: string[]) => {\n                    this.items.removeAll();\n                    this.items.addMany(items); s\n                },\n            },\n        };\n    }\n}\n'})})}),(0,i.jsx)(c.c,{value:"service",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'...\ninterface CustomServiceProperties extends ComponentModelProperties {\n    items?: string[];\n}\n\n@serializable\nexport default class CustomServiceWithConfig extends ConfigurableServiceBase<\n    CustomServiceProperties\n> {\n    items: Collection<string> = new Collection<string>();\n\n    ...\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        // highlight-next-line\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            items: {\n\n                serializeModes: ["initial"],\n                default: ["Some Default Value"],\n                serialize: () => this.items.toArray(),\n                deserialize: (items: string[]) => {\n                    this.items.removeAll();\n                    this.items.addMany(items); s\n                },\n            },\n        };\n    }\n}\n'})})})]}),"\n",(0,i.jsxs)(n.p,{children:["Already serializable properties such as ",(0,i.jsx)(n.code,{children:"boolean"})," values or ",(0,i.jsx)(n.code,{children:"string"})," values can have their serialization logic omitted."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'...\ninterface ExampleComponentModelProperties extends ComponentModelProperties {\n    stringVal?: string;\n}\n\n@serializable\nexport default class ExampleComponentModel extends ComponentModelBase<\n    ExampleComponentModelProperties\n> {\n    stringVal: string;\n\n    protected _getSerializableProperties(): PropertyDefs<\n        ExampleComponentModelProperties\n    > {\n        const props = super._getSerializableProperties();\n        return {\n            ...props,\n            stringVal: {\n                serializeModes: ["initial"],\n                default: "Simple String Value",\n            },\n        };\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"serialization-modes",children:"Serialization Modes"}),"\n",(0,i.jsx)(n.p,{children:"Every property has a number of serialization modes it can use to persist the values."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'export declare type SerializeMode = "initial" | "all" | "preferences";\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"initial"})," will serialize to the app config JSON only if it is different from the default."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"all"})," will serialize all values to the app config JSON every time."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"preferences"})," will serialize the value to storage which will persist between application loads, but only apply to a single user."]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(l.c,{children:[(0,i.jsx)(s.c,{title:"Check out the Component Reference for Configuration",description:"Learn more about how components interact with configuration",link:(0,o.c)("docs/web/sdk-components-reference#configuration")}),(0,i.jsx)(s.c,{title:"Check out the Service Reference for Configuration",description:"Learn more about how services interact with configuration",link:(0,o.c)("docs/web/sdk-services-reference#models-and-configuration")})]})]})}function g(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(f,{...e})}):f(e)}},5388:(e,n,t)=>{t.d(n,{c:()=>s});t(1504);var i=t(4064);const r={tabItem:"tabItem_Ymn6"};var o=t(7624);function s({children:e,hidden:n,className:t}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,i.c)(r.tabItem,t),hidden:n,children:e})}},1268:(e,n,t)=>{t.d(n,{c:()=>S});var i=t(1504),r=t(4064),o=t(3943),s=t(5592),l=t(5288),a=t(632),c=t(7128),d=t(1148);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:t,default:i}})=>({value:e,label:n,attributes:t,default:i})))}(t);return function(e){const n=(0,c.w)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const t=(0,s.Uz)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a._M)(r),(0,i.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})}),[r,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=p(e),[s,a]=(0,i.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:o}))),[c,u]=m({queryString:t,groupId:r}),[f,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,r]=(0,d.IN)(n);return[t,(0,i.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:r}),x=(()=>{const e=c??f;return h({value:e,tabValues:o})?e:null})();(0,l.c)((()=>{x&&a(x)}),[x]);return{selectedValue:s,selectValue:(0,i.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),g(e)}),[u,g,o]),tabValues:o}}var g=t(3664);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(7624);function v({className:e,block:n,selectedValue:t,selectValue:i,tabValues:s}){const l=[],{blockElementScrollPositionUntilNextRender:a}=(0,o.MV)(),c=e=>{const n=e.currentTarget,r=l.indexOf(n),o=s[r].value;o!==t&&(a(n),i(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.c)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:i})=>(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>l.push(e),onKeyDown:d,onClick:c,...i,className:(0,r.c)("tabs__item",x.tabItem,i?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function j({lazy:e,children:n,selectedValue:t}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===t));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function C(e){const n=f(e);return(0,b.jsxs)("div",{className:(0,r.c)("tabs-container",x.tabList),children:[(0,b.jsx)(v,{...e,...n}),(0,b.jsx)(j,{...e,...n})]})}function S(e){const n=(0,g.c)();return(0,b.jsx)(C,{...e,children:u(e.children)},String(n))}},7528:(e,n,t)=>{t.d(n,{c:()=>l});var i=t(867),r=(t(1504),t(4971));const o={root:"root_Uwqo"};var s=t(7624);function l({title:e,description:n,link:t}){return(0,s.jsx)("div",{className:(0,r.c)("card-demo",o.root),children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card__header",children:(0,s.jsx)("h3",{children:e})}),(0,s.jsx)("div",{className:"card__body",children:(0,s.jsx)("p",{children:n})}),(0,s.jsx)("div",{className:"card__footer",children:(0,s.jsx)(i.c,{className:"button button--secondary button--block",to:t,children:"Get Started"})})]})})}},7160:(e,n,t)=>{t.d(n,{c:()=>o});t(1504);const i={root:"root_vxd5"};var r=t(7624);function o({children:e}){return(0,r.jsx)("div",{className:i.root,children:e})}},4971:(e,n,t)=>{function i(e){var n,t,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(t=i(e[n]))&&(r&&(r+=" "),r+=t);else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}t.d(n,{c:()=>r});const r=function(){for(var e,n,t=0,r="";t<arguments.length;)(e=arguments[t++])&&(n=i(e))&&(r&&(r+=" "),r+=n);return r}},2172:(e,n,t)=>{t.d(n,{I:()=>l,M:()=>s});var i=t(1504);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);