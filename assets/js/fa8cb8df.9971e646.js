"use strict";(globalThis.webpackChunkvertigis_studio_dev_center=globalThis.webpackChunkvertigis_studio_dev_center||[]).push([[6099],{1817:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"web/tutorial-common-lifecycle-hooks","title":"Lifecycle Hooks for Starting Workflows","description":"VertiGIS Studio Web - Learn what lifecycle hooks are available and when to use them.","source":"@site/docs/web/tutorial-common-lifecycle-hooks.mdx","sourceDirName":"web","slug":"/web/tutorial-common-lifecycle-hooks","permalink":"/docs/web/tutorial-common-lifecycle-hooks","draft":false,"unlisted":false,"editUrl":"https://github.com/vertigis/studio-dev-center/edit/master/docs/web/tutorial-common-lifecycle-hooks.mdx","tags":[],"version":"current","frontMatter":{"title":"Lifecycle Hooks for Starting Workflows","description":"VertiGIS Studio Web - Learn what lifecycle hooks are available and when to use them."},"sidebar":"web","previous":{"title":"Change Default Map Click Behavior","permalink":"/docs/web/tutorial-change-default-map-click-behavior"},"next":{"title":"Implement a Custom Activity","permalink":"/docs/web/tutorial-implement-custom-activity"}}');var i=n(4848),a=n(8453),r=n(6025);const s={title:"Lifecycle Hooks for Starting Workflows",description:"VertiGIS Studio Web - Learn what lifecycle hooks are available and when to use them."},l="Lifecycle Hooks for Starting Workflows",c={},h=[{value:"Application Initializing",id:"application-initializing",level:2},{value:"Application Initialized",id:"application-initialized",level:2},{value:"Map Initialized",id:"map-initialized",level:2},{value:"Run Workflow Command (workflow.run)",id:"run-workflow-command-workflowrun",level:2},{value:"Evaluate Workflow Operation (workflow.evaluate)",id:"evaluate-workflow-operation-workflowevaluate",level:2},{value:"ui.activate Command Workflow Component",id:"uiactivate-command-workflow-component",level:2},{value:"Dedicated Workflow form",id:"dedicated-workflow-form",level:2},{value:"Workflow Target",id:"workflow-target",level:2},{value:"WebMaps in Workflow",id:"webmaps-in-workflow",level:2},{value:"Esri Graphics and Web Features",id:"esri-graphics-and-web-features",level:2},{value:"Graphic to Feature",id:"graphic-to-feature",level:2},{value:"Feature to Graphic",id:"feature-to-graphic",level:2},{value:"Passing Application Items to Workflow",id:"passing-application-items-to-workflow",level:2}];function d(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.header,{children:(0,i.jsx)(o.h1,{id:"lifecycle-hooks-for-starting-workflows",children:"Lifecycle Hooks for Starting Workflows"})}),"\n",(0,i.jsx)(o.p,{children:"This article will tell you about common lifecycle hooks within Web and when you should use them for starting Workflows."}),"\n",(0,i.jsx)(o.h1,{id:"services--app--events-",children:"Services > App > Events >"}),"\n",(0,i.jsx)(o.h2,{id:"application-initializing",children:"Application Initializing"}),"\n",(0,i.jsx)(o.p,{children:"Event gets executed when Web begins to initialize. Commands or Workflows used here must not contain blocking actions such as alerts or user-facing forms; these will prevent the application from loading. This can be useful for launching Workflows that are going to impact the initial state of the application (such as initial layout)."}),"\n",(0,i.jsx)(o.h2,{id:"application-initialized",children:"Application Initialized"}),"\n",(0,i.jsx)(o.p,{children:"This event gets executed when Web has initialized. Commands or Workflows used here must not contain blocking actions such as alerts or user-facing forms; these will prevent the application from loading in Designer."}),"\n",(0,i.jsx)(o.h1,{id:"components--map--events-",children:"Components > Map > Events >"}),"\n",(0,i.jsx)(o.h2,{id:"map-initialized",children:"Map Initialized"}),"\n",(0,i.jsx)(o.p,{children:"This is an event that gets triggered when the map is initialized. The map is initialized when it is loaded for the first time, a user signs in or out, or in Mobile when a map area is activated or deactivated. This can be useful for displaying a Workflow that presents UI such as a form or for a Workflow that depends upon map data."}),"\n",(0,i.jsx)(o.h1,{id:"services--launch-link-workflows",children:"Services > Launch Link Workflows"}),"\n",(0,i.jsx)(o.p,{children:"Using the Launch Link service you can add and remove Workflows to the app that can be optionally specified and run by a URL parameter. The launch link Workflow is run at the same time as the Map Initialized Event. This can be useful for passing in information such as an asset id and then using a Workflow to have Web start with that asset already centered and selected."}),"\n",(0,i.jsx)("img",{src:(0,r.Ay)("img/web-workflow-lifecycle-launch-link-3.png")}),"\n",(0,i.jsx)(o.p,{children:"You can generate these URLs via Web Designer's App Launch Link Dialog. (Deploy > Development > 3 Dot Menu > Get Links)"}),"\n",(0,i.jsx)("img",{src:(0,r.Ay)("img/web-workflow-lifecycle-launch-link-1.png")}),"\n",(0,i.jsx)(o.p,{children:"Use the generated link to run the specified workflow at startup."}),"\n",(0,i.jsx)("img",{src:(0,r.Ay)("img/web-workflow-lifecycle-launch-link-2.png")}),"\n",(0,i.jsx)(o.h1,{id:"event-service",children:"Event Service"}),"\n",(0,i.jsxs)(o.p,{children:["You can configure a Workflow to run on any VertiGIS Studio Web ",(0,i.jsx)(o.a,{href:"https://developers.vertigisstudio.com/docs/Web/api-commands-operations-events/#events",children:"Event"})," by registering an event listener in the ",(0,i.jsx)(o.a,{href:"https://developers.vertigisstudio.com/blog/2023/03/01/mobile-generic-event-listener/",children:"Event service"}),"."]}),"\n",(0,i.jsx)(o.admonition,{title:"Warning: In general configuring an event listener for a Workflow that contains alerts or forms can be undesirable. Special consideration should also be given to the performance of a Workflow that is triggered by an Event that is likely to run often, as this could degrade the user experience.",type:"danger"}),"\n",(0,i.jsx)(o.h1,{id:"different-ways-to-launch-a-new-workflow-when-to-use-which-and-why",children:"Different ways to launch a new Workflow. When to use which and why?"}),"\n",(0,i.jsx)(o.h2,{id:"run-workflow-command-workflowrun",children:"Run Workflow Command (workflow.run)"}),"\n",(0,i.jsx)(o.p,{children:"Used to start a Workflow on user activity, often executed from IWTM, menu, or button component. This is the most common way to launch a Workflow; you will generally use a variant of this command unless you need to utilize a result from the Workflow."}),"\n",(0,i.jsx)(o.p,{children:"Variants: Run Asynchronously, use this flag if you want the command to return immediately and not wait on the Workflow to finish. This may be useful if your workflow.run is in a command chain that you want to continue to completion without waiting for the Workflow to finish."}),"\n",(0,i.jsx)(o.h2,{id:"evaluate-workflow-operation-workflowevaluate",children:"Evaluate Workflow Operation (workflow.evaluate)"}),"\n",(0,i.jsxs)(o.p,{children:["Workflows can be configured to return a result on completion. If you want to use this value in Web you need to configure the Workflow to be run as an operation. This is accomplished by manually configuring the command chain in App Designer's commands control in advanced mode, and changing the command name from ",(0,i.jsx)(o.code,{children:"workflow.run"})," to ",(0,i.jsx)(o.code,{children:"workflow.evaluate"}),". Note that Mobile does not support ",(0,i.jsx)(o.code,{children:"workflow.evaluate"})," and its implementation of ",(0,i.jsx)(o.code,{children:"workflow.run"})," returns a result."]}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-json",metastring:'title="Advanced Mode Configuration"',children:'[\n    {\n        "name": "workflow.evaluate",\n        "arguments": {\n          ...\n        }\n    }\n]\n'})}),"\n",(0,i.jsx)(o.h2,{id:"uiactivate-command-workflow-component",children:"ui.activate Command Workflow Component"}),"\n",(0,i.jsx)(o.p,{children:'Another common pattern for launching a Workflow is to configure the Workflow in a dedicated form (see different ways to control where the Workflow form shows up), and to set it as initially hidden. You can then configure the "Show Component" tool (ui.activate command) via any other method (for example a new item in the I Want to menu). Once run the form should activate and run the configured Workflow.'}),"\n",(0,i.jsx)(o.h1,{id:"different-ways-to-control-where-workflow-forms-show-up",children:"Different Ways to Control Where Workflow Forms Show Up"}),"\n",(0,i.jsx)(o.h2,{id:"dedicated-workflow-form",children:"Dedicated Workflow form"}),"\n",(0,i.jsx)(o.p,{children:"Workflow forms components allow you to configure an optional persistent Workflow. This Workflow will be launched when the form is activated, and the form will be deactivated when the Workflow completes. This form will only be used for the dedicated Workflow and not considered for displaying any other Workflow form. This can allow you to use a Workflow form and have it appear as an always-running integrated part of a Web UI. Note this behavior is not consistent with Mobile where forms with a persistent Workflow can still be targeted by other Workflows."}),"\n",(0,i.jsx)("img",{src:(0,r.Ay)("img/web-workflow-lifecycle-form-1.png")}),"\n",(0,i.jsx)(o.h2,{id:"workflow-target",children:"Workflow Target"}),"\n",(0,i.jsx)(o.p,{children:"When you configure a Workflow to be executed as an action in a button or menu item you are given the choice of target container. By default the Target is set to \u2018Auto\u2019 which will select the first Workflow form container in the layout that does not have a persistent Workflow."}),"\n",(0,i.jsx)(o.p,{children:"Optionally you can target any other layout components that supports children, including tabs, panels, stacks, etc."}),"\n",(0,i.jsx)(o.h2,{id:"webmaps-in-workflow",children:"WebMaps in Workflow"}),"\n",(0,i.jsxs)(o.p,{children:["If you want to interact with the WebMap in your Web application, this is easily accomplished using Workflow's ",(0,i.jsx)(o.code,{children:"Get Map"})," activity.\nThis activity gives you access to both the Esri map or scene, Esri view and the VertiGIS Web MapExtension object that wraps the map and provides access to VertiGIS Web specific functionality."]}),"\n",(0,i.jsx)(o.p,{children:"For example, in Workflow:"}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-js",metastring:'title="Workflow snippet"',children:"=map1.extension\n=map1.view\n=map1.map\n"})}),"\n",(0,i.jsx)(o.h2,{id:"esri-graphics-and-web-features",children:"Esri Graphics and Web Features"}),"\n",(0,i.jsx)(o.p,{children:"Commonly you may write a Workflow that accepts an input of Web features and want to work with Esri graphics or have a Workflow that produces Graphics and want Web to interact with them (for example display in the Results List or Table of Feature Summary). Web exposes operations to handle these conversions:"}),"\n",(0,i.jsx)(o.h2,{id:"graphic-to-feature",children:"Graphic to Feature"}),"\n",(0,i.jsxs)(o.p,{children:["This can be accomplished using Web's ",(0,i.jsx)(o.code,{children:"results.from-graphics"})," operation."]}),"\n",(0,i.jsx)(o.h2,{id:"feature-to-graphic",children:"Feature to Graphic"}),"\n",(0,i.jsxs)(o.p,{children:["This can be accomplished using Web's ",(0,i.jsx)(o.code,{children:"results.to-graphics"})," operation."]}),"\n",(0,i.jsx)(o.p,{children:"These two operations allow you convert between Graphics and Features easily, but when you are converting from a Graphic that was created in Workflow you will need to provide Web with some additional information in order to associate the new Feature with the correct Web FeatureSource (Layer, Sublayer, etc.). This will allow Web to properly resolve the correct Popup Configuration, Related Records etc."}),"\n",(0,i.jsxs)(o.p,{children:["In order to accomplish this you will need to specify the map and layer to the ",(0,i.jsx)(o.code,{children:"results.from-graphics"})," operation."]}),"\n",(0,i.jsxs)(o.p,{children:["Operation Name: ",(0,i.jsx)(o.code,{children:"results.from-graphics"})]}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-js",metastring:'title="Workflow Operation Parameter"',children:"{\n    graphics: [g1, g2, \u2026],\n    layer: $layer1.layer,\n    map: $map1.map.map,\n}\n"})}),"\n",(0,i.jsx)(o.h2,{id:"passing-application-items-to-workflow",children:"Passing Application Items to Workflow"}),"\n",(0,i.jsx)(o.p,{children:"It is easy to pass Web items to Workflows using Web's model item:// URI. You can obtain this from App Designer by clicking on the component's setting Cog in App Designer, and copying the model URI from the popup dialog."}),"\n",(0,i.jsx)("img",{src:(0,r.Ay)("img/web-workflow-lifecycle-web-items-1.png")}),"\n",(0,i.jsx)(o.p,{children:"You can then use this value when configuring your Workflows input arguments."}),"\n",(0,i.jsx)(o.pre,{children:(0,i.jsx)(o.code,{className:"language-json",metastring:'title="Advanced Mode Configuration"',children:'[\n  {\n    "name": "workflow.run",\n    "arguments": {\n      "commandArgumentInput": "context",\n      "inputs": {\n        "map": "item://map-extension/default"\n      }\n      ...\n    }\n  }\n]\n'})})]})}function u(e={}){const{wrapper:o}={...(0,a.R)(),...e.components};return o?(0,i.jsx)(o,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,o,n)=>{n.d(o,{R:()=>r,x:()=>s});var t=n(6540);const i={},a=t.createContext(i);function r(e){const o=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:o},e.children)}}}]);